var ParameterDefinition=function(){function e(e,t,r,n){this.validTypes=["boolean","number","string","symbol","function","object"],this.name=e,this.type=t,r?this.optional=!0:this.optional=!1,this.description=n||"",this.performValidParameterDefinitionCheck(this)}return e.prototype.validType=function(e){for(var t=0,r=this.validTypes;t<r.length;t++){var n=r[t];if(e===n)return!0}return!1},e.prototype.performValidParameterDefinitionCheck=function(e){if("string"!=typeof e.name||e.name.length<=0)throw new Error("Expected the parameter name to be a string with at least 1 character.");if("boolean"!=typeof e.optional)throw new Error("Expected optional of parameter "+e.name+" to be a boolean.");if(!this.validType(e.type))throw new Error('The type "'+e.type+'" of parameter '+e.name+' is not a valid JavaScript type. Expected type to be "boolean" or "number" or "string" etc.\nNote: Arrays and instantiations of custom classes have type "object", and classes have type "function".');if("string"!=typeof e.description)throw new Error("Expected description of parameter "+e.name+" to be a string.")},e}(),PublisherEvent=function(){function e(e,t,r,n){this.handlers=[],this.name=e,this.description=r||"",this.registrant=n,this.parameters=t||[],this.validParameterDefinitionArray(this.parameters)||(this.parameters=this.convertToParameterDefinitionArray(this.parameters)),this.performValidPublisherEventCheck(this)}return e.prototype.convertToParameterDefinitionArray=function(e){if(!(e instanceof Array))throw new Error("Expected parameters to be an array of parameter definitions (the array can be empty).");for(var t=0,r=void 0;r=e[t];t+=1){if("object"!=typeof r)throw new Error("Unexpected parameter definition.");e[t]=new ParameterDefinition(r.name,r.type,r.optional,r.description)}return e},e.prototype.validParameterOrder=function(e){for(var t=!1,r=0,n=e;r<n.length;r++){var i=n[r];if(i.optional&&(t=!0),t&&!i.optional)return!1}return!0},e.prototype.checkForDuplicateParameters=function(e){for(var t={},r=0,n=void 0;n=e[r];r+=1){if(t[n.name])return r;t[n.name]=!0}return-1},e.prototype.validParameterDefinitionArray=function(e){if(!(e instanceof Array))return!1;for(var t=0,r=e;t<r.length;t++){var n=r[t];if(!(n instanceof ParameterDefinition))return!1}return!0},e.prototype.performValidPublisherEventCheck=function(e){if("string"!=typeof e.name||e.name.length<=0)throw new Error("Expected the event name to be a string with at least 1 character.");var t=e.checkForDuplicateParameters(e.parameters);if(t>-1)throw new Error("Parameter "+t+" of the event parameters is already defined.");if(!this.validParameterOrder(e.parameters))throw new Error("A required parameter cannot follow an optional parameter.");if("string"!=typeof e.description)throw new Error("Expected description of event "+e.name+" to be a string.")},e.prototype.checkHandlersArgumentsMatchParametersDefined=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];for(var r=0,n=void 0;n=this.parameters[r];r+=1)if(typeof e[r]!==n.type){if(!n.optional)throw new Error("The handler parameters given don't match those defined for "+("event "+this.name+". Expected argument "+r+' to be of type "'+n.type+'" ')+('but found type "'+typeof e[r]+'".'));if("undefined"!=typeof e[r])throw new Error("The handler parameters given don't match those defined for "+("event "+this.name+". Expected argument "+r+' to be of type "'+n.type+'" ')+('but found type "'+typeof e[r]+'".'))}},e}(),Publisher=function(){function e(e){this.subscriptions={},this.registeredEvents=[],e?this.checkEventAndArgumentsOnPublish=!0:this.checkEventAndArgumentsOnPublish=!1}return e.prototype.eventIndex=function(e){for(var t,r=0;t=this.registeredEvents[r];r+=1)if(t.name===e)return r;return-1},e.prototype.getEvent=function(e){if(!e)throw new Error("Expected an event name.");var t=this.eventIndex(e);if(t>-1){var r=this.registeredEvents[t];return r.handlers=this.subscriptions[e]||[],r}throw new Error("Event "+e+" is not registered. Cannot get an event that isn't registered.")},e.prototype.getAllEvents=function(){for(var e=[],t=0,r=this.registeredEvents;t<r.length;t++){var n=r[t];e.push(this.getEvent(n.name))}return e},e.prototype.getEventDescription=function(e){return this.getEvent(e).description},e.prototype.getEventHandlers=function(e){return this.getEvent(e).handlers},e.prototype.getEventParameters=function(e){return this.getEvent(e).parameters},e.prototype.getEventRegistrant=function(e){return this.getEvent(e).registrant},e.prototype.isRegistered=function(e){return this.eventIndex(e)>-1},e.prototype.register=function(e,t,r,n){if(!e||e.length<=0)throw new Error("Expected an event name with at least 1 character in order to register an event.");if(this.isRegistered(e))throw new Error("Event "+e+" is already registered.");var i=new PublisherEvent(e,t,r,n);this.registeredEvents.push(i)},e.prototype.deregister=function(e){if(!e)throw new Error("Expected an event name to deregister.");var t=this.eventIndex(e);if(!(t>-1))throw new Error("Event "+e+" is not registered. Cannot deregister and event that isn't registered.");this.unsubscribe(e),this.registeredEvents.splice(t,1)},e.prototype.deregisterAll=function(){this.subscriptions={},this.registeredEvents=[]},e.prototype.subscribe=function(e,t){if(!e)throw new Error("Expected an event name to subscribe.");if(!this.isRegistered(e))throw new Error("Event "+e+" is not registered. Cannot subscribe to an event that isn't registered.");if(!t)throw new Error("Expected an event handler.");for(var r=this.getEvent(e),n=0,i=0,o=r.parameters;i<o.length;i++){var s=o[i];if(s.optional)break;n+=1}if(n>t.length){for(var a="",p=0,s=void 0;s=r.parameters[p];p+=1)p>0&&p<r.parameters.length&&(a+=", "),a+=s.name+(s.optional?"?":"")+": "+s.type;throw new Error("Expected ("+a+") parameters for the event "+e+" handlers. The event handler does not cater for the required paramters. "+("At least "+n+" expected, "+t.length+" found."))}return this.subscriptions.hasOwnProperty(e)||(this.subscriptions[e]=[]),this.subscriptions[e].push(t),t},e.prototype.unsubscribe=function(e,t){if(!e)throw new Error("Expected an event name to unsubscribe.");if(!this.isRegistered(e))throw new Error("Event "+e+" is not registered. Cannot unsubscribe from an event that isn't registered.");if(!this.subscriptions.hasOwnProperty(e))return!1;if(t){var r=this.subscriptions[e].indexOf(t);r>-1&&(this.subscriptions[e].splice(r,1),this.subscriptions[e].length<=0&&delete this.subscriptions[e])}else delete this.subscriptions[e];return!0},e.prototype.publish=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!e)throw new Error("Expected an event name to publish.");var n=this.subscriptions[e]||[];if(this.checkEventAndArgumentsOnPublish)for(var i=this.getEvent(e),o=0,s=void 0;s=n[o];o+=1)i.checkHandlersArgumentsMatchParametersDefined.apply(i,t);for(var o=0,s=void 0;s=n[o];o+=1)s.apply(void 0,t)},e}(),publisher=new Publisher((!0));